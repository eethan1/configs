#! /usr/bin/env -S uv run --script
# /// script
# requires-python = ">=3.11"
# dependencies = [
#   "mmh3",
#   "requests",
# ]
# ///
import mmh3
import requests
import sys
import codecs
import hashlib
target=sys.argv[1]
resp = requests.get(target, verify=False)
favicon = codecs.encode(resp.content,'base64')
mmh3_hash = mmh3.hash(favicon)
md5_hash = hashlib.md5(resp.content).hexdigest()
print(f'mmh3={mmh3_hash}')
print(f'md5={md5_hash}')
print(f'shodan: http.favicon.hash:{mmh3_hash}')
print(f'zoomeye: iconhash=="{mmh3_hash}"')
print(f'censys: {md5_hash}')

