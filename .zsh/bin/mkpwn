#! /usr/bin/env zsh
mkdir $1
cat > "$1/exp.py" << EOF
from pwn import *
context.arch = 'i386' # 'amd64'

r = process('./')
r = remote('chall.pwnable.tw',)

input()

r.interactive()
EOF
cat > "$1/note" << EOF
x86_64
syscall rax
User

rdi
rsi
rdx
rcx
r8
r9

Kernel

rdi
rsi
rdx
r10
r8
r9

i386
syscall eax, int 0x80

ebx
ecx
edx
esx
edi
EOF

